# 英语口语面板（SpeakingPanel）- 交互设计方案

<document-overview>
  <name>Speaking Panel Design</name>
  <description>英语口语面板的二级选项设计方案，基于需求文档和现有交互逻辑</description>
  <version>1.0</version>
  <date>2026-01-27</date>
</document-overview>

---

## 一、需求分析

### 1.1 核心功能模块（来自需求文档）

根据《英语口语迭代-需求文档（对接）》，英语口语功能包含以下核心模块：

| 模块 | 说明 | 特点 |
|------|------|------|
| **任务对话** | 包含短文朗读、个人演讲 | 有明确任务目标，AI生成练习内容 |
| **基础对话** | 日常话题的简单对话 | 围绕个人经历、家庭、朋友等话题 |
| **深度对话** | 抽象/专业话题的深入探讨 | 更深层次的追问，培养思辨能力 |
| **角色对话** | 与虚拟角色（Elsa、Alice等）对话 | 代入角色性格和经历，趣味性强 |
| **场景对话** | 30个内置场景的情境对话 | 有明确任务完成形态，如点餐、问路 |
| **自由对话** | 无限制的开放式对话 | 学生主导话题 |

### 1.2 全局参数设置

- **年级**：小学一年级 ~ 中学三年级（9个年级）
- **难度**：简单、一般、困难
- **词汇控制**：A1-A2级（初级）与 B1-B2级（中级）词汇比例
- **句式控制**：简单句与复合句比例、单句长度限制

### 1.3 现有面板交互模式参考

| 面板 | 结构 | 交互模式 |
|------|------|----------|
| **ToolsPanel** | 工具网格 → 配置页 | 点击工具卡片 → 显示配置表单 → 添加到课件 |
| **AppsPanel** | 2个入口卡片 | 点击卡片 → 打开浮窗/弹窗 |
| **WebPanel** | 3个入口卡片 → 配置页 | 点击卡片 → 切换到配置视图 |
| **ResourcesPanel** | 4个入口卡片 | 点击卡片 → 打开对应浮窗 |

---

## 二、设计方案

### 2.1 面板结构设计

采用 **两级结构**：入口卡片 + 配置页面

```
┌─────────────────────────────────────────┐
│  添加英语口语                      [<]   │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────┐  ┌─────────────┐      │
│  │     📖     │  │     🎤     │      │
│  │   任务对话   │  │   场景对话   │      │
│  │  短文朗读/演讲 │  │  30个内置场景 │      │
│  └─────────────┘  └─────────────┘      │
│                                         │
│  ┌─────────────┐  ┌─────────────┐      │
│  │     💬     │  │     🎭     │      │
│  │   日常对话   │  │   角色对话   │      │
│  │  基础/深度对话 │  │  与虚拟角色聊天│      │
│  └─────────────┘  └─────────────┘      │
│                                         │
│  ┌─────────────┐  ┌─────────────┐      │
│  │     🌟     │  │     📊     │      │
│  │   自由对话   │  │   口语中心   │      │
│  │  开放式练习  │  │  浏览更多模板 │      │
│  └─────────────┘  └─────────────┘      │
│                                         │
└─────────────────────────────────────────┘
```

### 2.2 六个二级选项详解

#### 选项 1：任务对话

| 属性 | 内容 |
|------|------|
| **图标** | 📖 书本/朗读图标 |
| **名称** | 任务对话 |
| **副标题** | 短文朗读 / 个人演讲 |
| **功能** | AI生成朗读材料或演讲题目，学生完成指定任务 |
| **点击后** | 进入配置页，选择任务类型（短文朗读/个人演讲）、主题、年级、难度 |

**配置页设计：**
```
┌─────────────────────────────────────────┐
│  ← 任务对话                              │
├─────────────────────────────────────────┤
│                                         │
│  任务类型                                │
│  ┌──────────┐  ┌──────────┐            │
│  │ 短文朗读  │  │ 个人演讲  │            │
│  └──────────┘  └──────────┘            │
│                                         │
│  练习主题                                │
│  ┌─────────────────────────────────┐   │
│  │ 请输入或选择主题...         ▼   │   │
│  └─────────────────────────────────┘   │
│  推荐：踏青、演唱会、我的宠物、周末活动    │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │          添加到课件              │   │
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

---

#### 选项 2：场景对话

| 属性 | 内容 |
|------|------|
| **图标** | 🎤 麦克风/场景图标 |
| **名称** | 场景对话 |
| **副标题** | 30个内置场景 |
| **功能** | 在预设场景中完成具体任务（如点餐、问路、购物） |
| **点击后** | 进入配置页，通过多级下拉选择场景 |

**30个内置场景分类：**

| 大类 | 子场景 |
|------|--------|
| 日常对话 | 询问路线、天气聊天、时间询问、自我介绍 |
| 校园生活 | 课堂互动、宿舍闲聊、图书馆借书、食堂点餐 |
| 购物消费 | 超市购物、服装店试衣、文具店购买 |
| 餐饮美食 | 餐厅点餐、快餐店点单、饮品店点单 |
| 交通出行 | 乘坐公交、地铁问路、出租车叫车 |
| 节日活动 | 节日祝福、生日派对、新年庆祝 |
| 就医安全 | 就医咨询、药店买药 |
| 其他场景 | 电话沟通、邮局寄信、银行办事 |

**配置页设计：**
```
┌─────────────────────────────────────────┐
│  ← 场景对话                              │
├─────────────────────────────────────────┤
│                                         │
│  选择场景                                │
│  ┌─────────────────────────────────┐   │
│  │ 大类：日常对话              ▼   │   │
│  └─────────────────────────────────┘   │
│  ┌─────────────────────────────────┐   │
│  │ 子场景：询问路线            ▼   │   │
│  └─────────────────────────────────┘   │
│                                         │
│  场景预览                                │
│  ┌─────────────────────────────────┐   │
│  │ 🗺️ 放学后在路边，你想去游乐园   │   │
│  │ 玩，需要向路人询问路线...       │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │          添加到课件              │   │
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

---

#### 选项 3：日常对话

| 属性 | 内容 |
|------|------|
| **图标** | 💬 对话气泡图标 |
| **名称** | 日常对话 |
| **副标题** | 基础对话 / 深度对话 |
| **功能** | 与AI进行日常话题或深度话题的对话练习 |
| **点击后** | 进入配置页，选择对话类型 |

**配置页设计：**
```
┌─────────────────────────────────────────┐
│  ← 日常对话                              │
├─────────────────────────────────────────┤
│                                         │
│  对话类型                                │
│  ┌─────────────────────────────────┐   │
│  │  ☀️ 基础对话                     │   │
│  │  围绕日常话题轻松聊天            │   │
│  │  话题：周末活动、早餐、爱好...    │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │  🧠 深度对话                     │   │
│  │  探讨抽象话题，培养思辨能力      │   │
│  │  话题：梦想、植物、宇宙...       │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │          添加到课件              │   │
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

---

#### 选项 4：角色对话

| 属性 | 内容 |
|------|------|
| **图标** | 🎭 面具/角色图标 |
| **名称** | 角色对话 |
| **副标题** | 与虚拟角色聊天 |
| **功能** | 与预设的虚拟角色（Elsa、Alice、麦兜等）进行对话 |
| **点击后** | 进入角色选择页面 |

**预设角色列表：**

| 角色 | 来源 | 性别 | 特点 |
|------|------|------|------|
| Elsa | 冰雪奇缘 | 女 | 冷静、内敛、有责任感 |
| Alice | 爱丽丝梦游仙境 | 女 | 好奇、勇敢、充满想象力 |
| McDull | 麦兜故事 | 男 | 乐观、纯真、梦想成为厨师 |
| Harry Potter | 哈利波特 | 男 | 勇敢、忠诚、有正义感 |
| 更多角色... | - | - | 可扩展 |

**配置页设计：**
```
┌─────────────────────────────────────────┐
│  ← 角色对话                              │
├─────────────────────────────────────────┤
│                                         │
│  选择对话角色                            │
│                                         │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐          │
│  │❄️  │ │🐰  │ │🐷  │ │⚡  │          │
│  │Elsa│ │Alice│ │麦兜│ │Harry│         │
│  └────┘ └────┘ └────┘ └────┘          │
│                                         │
│  角色介绍                                │
│  ┌─────────────────────────────────┐   │
│  │ ❄️ Elsa - 冰雪奇缘              │   │
│  │ 阿伦黛尔王国的公主，拥有控制冰雪  │   │
│  │ 的魔法能力，性格冷静、有责任感    │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │          添加到课件              │   │
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

---

#### 选项 5：自由对话

| 属性 | 内容 |
|------|------|
| **图标** | 🌟 星星/自由图标 |
| **名称** | 自由对话 |
| **副标题** | 开放式练习 |
| **功能** | 无预设话题，学生自由发起对话 |
| **点击后** | 直接添加到课件（无需额外配置）或简单配置 |

**配置页设计（简化版）：**
```
┌─────────────────────────────────────────┐
│  ← 自由对话                              │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │         🌟                       │   │
│  │                                  │   │
│  │    自由对话模式                   │   │
│  │    学生可以自由发起任何话题       │   │
│  │    AI会根据学生水平自适应调整     │   │
│  │                                  │   │
│  └─────────────────────────────────┘   │
│                                         │
│  对话引导（可选）                         │
│  ┌─────────────────────────────────┐   │
│  │ 输入引导语或留空...              │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │          添加到课件              │   │
│  └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

---

#### 选项 6：口语中心

| 属性 | 内容 |
|------|------|
| **图标** | 📊 网格/中心图标 |
| **名称** | 口语中心 |
| **副标题** | 浏览更多模板 |
| **功能** | 打开浮窗，浏览和筛选更多口语练习模板 |
| **点击后** | 打开 speakingCenterModal 浮窗 |

**浮窗设计（参考 aiAppCenterModal）：**
```
┌─────────────────────────────────────────────────────────────┐
│  口语练习中心                                         [×]   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  筛选：[类型 ▼]  [年级 ▼]  [难度 ▼]  [场景 ▼]              │
│                                                             │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐       │
│  │ 餐厅点餐 │  │ 超市购物 │  │ 问路导航 │  │ 自我介绍 │       │
│  │ 场景对话 │  │ 场景对话 │  │ 场景对话 │  │ 任务对话 │       │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘       │
│                                                             │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐       │
│  │ 与Elsa  │  │ 周末活动 │  │ 我的梦想 │  │ 天气聊天 │       │
│  │ 角色对话 │  │ 基础对话 │  │ 深度对话 │  │ 基础对话 │       │
│  └─────────┘  └─────────┘  └─────────┘  └─────────┘       │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  已选择 2 个模板                    [取消]  [添加到课件]     │
└─────────────────────────────────────────────────────────────┘
```

---

## 三、全局配置设计

### 3.1 年级与难度设置

所有口语练习都需要配置年级和难度，建议在**课件全局设置**中统一配置，各练习模块继承全局设置。

```
┌─────────────────────────────────────────┐
│  全局设置（右侧面板或顶部）               │
├─────────────────────────────────────────┤
│                                         │
│  目标年级                                │
│  ┌─────────────────────────────────┐   │
│  │ 小学三年级                  ▼   │   │
│  └─────────────────────────────────┘   │
│                                         │
│  练习难度                                │
│  ○ 简单  ● 一般  ○ 困难                │
│                                         │
└─────────────────────────────────────────┘
```

### 3.2 难度参数映射表

| 年级段 | 难度 | A1-A2词汇占比 | 单句长度 | 简单句占比 |
|--------|------|---------------|----------|------------|
| 小一~小三 | 全部 | 100% | 4-7词 | 100% |
| 小四~小六 | 简单 | 90% | 7-12词 | 90% |
| 小四~小六 | 一般 | 90% | 10-20词 | 80% |
| 小四~小六 | 困难 | 80% | 10-20词 | 70% |
| 中一~中三 | 简单 | 90% | 10-25词 | 80% |
| 中一~中三 | 一般 | 80% | 10-25词 | 70% |
| 中一~中三 | 困难 | 70% | 10-25词 | 60% |

---

## 四、交互流程

### 4.1 状态变量

```typescript
// 新增状态变量
interface SpeakingState {
  currentSpeakingType: SpeakingType | null;  // 当前选中的口语类型
  selectedRole: string | null;                // 角色对话选中的角色
  selectedScene: {                            // 场景对话选中的场景
    category: string;
    subScene: string;
  } | null;
  dialogueType: 'basic' | 'deep' | null;      // 日常对话类型
  taskType: 'reading' | 'speech' | null;      // 任务对话类型
}

type SpeakingType =
  | 'task'      // 任务对话
  | 'scene'     // 场景对话
  | 'daily'     // 日常对话
  | 'role'      // 角色对话
  | 'free';     // 自由对话
```

### 4.2 交互流程图

```
用户点击「英语口语」Tag
        │
        ▼
┌───────────────────┐
│  显示 SpeakingPanel │
│  （6个入口卡片）     │
└───────────────────┘
        │
        ▼
┌───────────────────────────────────────────────────┐
│                    用户选择                        │
├─────────┬─────────┬─────────┬─────────┬──────────┤
│ 任务对话 │ 场景对话 │ 日常对话 │ 角色对话 │ 自由对话  │
└────┬────┴────┬────┴────┬────┴────┬────┴────┬─────┘
     │         │         │         │         │
     ▼         ▼         ▼         ▼         ▼
  配置页    配置页    配置页    配置页    配置页
  (类型+   (场景    (基础/   (角色    (引导语
   主题)   选择)    深度)    选择)    可选)
     │         │         │         │         │
     └─────────┴─────────┴─────────┴─────────┘
                         │
                         ▼
              ┌─────────────────┐
              │  添加到课件      │
              │  (创建口语页面)  │
              └─────────────────┘
                         │
                         ▼
              ┌─────────────────┐
              │  切换到编辑模式  │
              │  显示口语编辑区  │
              └─────────────────┘
```

---

## 五、类型定义

```typescript
// src/types/index.ts 新增

// 口语练习类型
export type SpeakingType =
  | 'task-reading'    // 短文朗读
  | 'task-speech'     // 个人演讲
  | 'scene'           // 场景对话
  | 'daily-basic'     // 基础对话
  | 'daily-deep'      // 深度对话
  | 'role'            // 角色对话
  | 'free';           // 自由对话

// 口语角色
export interface SpeakingRole {
  id: string;
  name: string;
  nameZh: string;
  source: string;
  gender: 'male' | 'female';
  avatar: string;
  description: string;
}

// 口语场景
export interface SpeakingScene {
  id: string;
  category: string;
  categoryZh: string;
  subScene: string;
  subSceneZh: string;
  description: string;
}

// 口语练习配置
export interface SpeakingConfig {
  type: SpeakingType;
  grade: string;
  difficulty: 'easy' | 'normal' | 'hard';
  role?: SpeakingRole;
  scene?: SpeakingScene;
  topic?: string;
  guidanceText?: string;
}
```

---

## 六、与现有系统的集成

### 6.1 PanelType 扩展

`speaking` 已在 `PanelType` 中定义，无需修改。

### 6.2 新增组件

| 组件 | 路径 | 说明 |
|------|------|------|
| SpeakingPanel | `src/components/panels/SpeakingPanel.tsx` | 口语面板主组件 |
| SpeakingCenterModal | `src/components/modals/SpeakingCenterModal.tsx` | 口语中心浮窗 |
| RoleSelector | `src/components/speaking/RoleSelector.tsx` | 角色选择器 |
| SceneSelector | `src/components/speaking/SceneSelector.tsx` | 场景选择器 |

### 6.3 LeftSidebar 集成

在 `LeftSidebar.tsx` 中添加 `SpeakingPanel` 的渲染逻辑：

```tsx
{editorState.activePanel === 'speaking' && (
  <SpeakingPanel onSelectSpeaking={handleSelectSpeaking} />
)}
```

---

## 七、设计原则

1. **一致性**：遵循现有面板的交互模式（卡片入口 → 配置页 → 添加到课件）
2. **渐进式**：从简单到复杂，低年级学生看到更简化的选项
3. **趣味性**：角色对话增加学习趣味，场景对话增加实用性
4. **灵活性**：支持全局设置继承，也支持单独配置
5. **可扩展**：角色和场景可后续扩展，口语中心支持筛选浏览

---

## 八、后续迭代方向

1. **发音评估集成**：在口语练习完成后显示发音评估报告
2. **学情数据看板**：教师端查看学生口语练习数据
3. **对话记录回放**：支持回放历史对话记录
4. **自定义角色**：教师可创建自定义对话角色
5. **自定义场景**：教师可创建自定义对话场景

---

**文档路径**: `/Users/cpaella/Documents/cocorobo/c-websites/enspeak/docs/英语口语面板-交互设计方案.md`
