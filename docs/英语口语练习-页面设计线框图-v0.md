# 英语口语练习 - 页面设计线框图

<document-overview>
  <name>English Speaking Practice - Wireframe Design</name>
  <description>英语口语练习功能的完整交互流程和页面设计</description>
  <version>1.0</version>
  <design-pattern>基于互动工具面板的交互模式</design-pattern>
</document-overview>

---

## 设计原则

<design-principles>
  <principle name="减少认知负担">
    3个核心选项，用户一眼即懂
  </principle>
  <principle name="概念清晰">
    场景（有任务）、对话（无任务）、朗读（单向输出）
  </principle>
  <principle name="全局设置前置">
    年级/难度全局配置，一次设置，处处生效
  </principle>
  <principle name="智能推荐">
    根据年级推荐适合的练习内容
  </principle>
  <principle name="快捷添加">
    支持 [+] 按钮快速添加默认配置
  </principle>
  <principle name="向后兼容">
    通过配置项保留所有原功能
  </principle>
</design-principles>

---

## 整体布局结构

<layout>
  <component name="left-container" position="左侧">
    <sub-component name="primary-menu">
      <tag id="speaking" name="口语练习" panel-id="speakingPanel">
        <icon>麦克风图标</icon>
      </tag>
    </sub-component>
    <sub-component name="secondary-panel" id="speakingPanel">
      <view name="speaking-list-view">练习模式选择网格</view>
      <view name="speaking-config-view">配置面板（隐藏，点击模式后显示）</view>
    </sub-component>
  </component>

  <component name="center-area" position="中央">
    <sub-component name="global-settings-bar">全局设置栏（年级/难度）</sub-component>
    <sub-component name="speaking-edit-area">口语练习编辑区域</sub-component>
    <sub-component name="bottom-outline">底部页面大纲</sub-component>
  </component>

  <component name="right-panel" position="右侧">
    <description>右侧大纲面板（显示练习列表）</description>
  </component>
</layout>

---

## 交互流程总览

<interaction-overview>
  <flow>
    <step number="1">点击【口语练习】Tag → 显示 speakingPanel</step>
    <step number="2">显示 speaking-list-view（3个模式卡片）</step>
    <step number="3">点击模式卡片 → 切换到 speaking-config-view</step>
    <step number="4">配置练习参数 → 点击【添加到课件】</step>
    <step number="5">中央工作区显示练习编辑界面</step>
    <step number="6">底部大纲添加练习缩略图</step>
  </flow>
</interaction-overview>

---

## 第一层：练习模式选择视图

<view id="speaking-list-view" name="练习模式选择">

  <structure>
    <header>
      <title>口语练习</title>
      <collapse-button>折叠按钮</collapse-button>
    </header>

    <intro-section>
      <illustration>插画：学生与AI对话的场景</illustration>
      <description>选择口语练习模式，系统将根据你的年级智能推荐内容</description>
    </intro-section>

    <mode-grid>
      <mode-card id="reading-speech" data-mode="reading">
        <icon>📖</icon>
        <title>朗读演讲</title>
        <subtitle>Reading & Speech</subtitle>
        <description>跟读课文、背诵诗歌、演讲训练</description>
        <badge>单向输出</badge>
      </mode-card>

      <mode-card id="free-dialogue" data-mode="dialogue">
        <icon>💬</icon>
        <title>自由对话</title>
        <subtitle>Free Dialogue</subtitle>
        <description>与AI角色自由交流，无固定任务</description>
        <badge>双向互动</badge>
      </mode-card>

      <mode-card id="scenario-task" data-mode="scenario">
        <icon>🎯</icon>
        <title>情景任务</title>
        <subtitle>Scenario Tasks</subtitle>
        <description>完成特定场景下的对话任务</description>
        <badge>目标导向</badge>
      </mode-card>
    </mode-grid>

    <quick-add-section>
      <tip>💡 提示：可直接点击 [+] 快速添加默认配置的练习</tip>
    </quick-add-section>
  </structure>

  <wireframe>
```
┌─────────────────────────────────────────┐
│ 口语练习                          [←]  │
├─────────────────────────────────────────┤
│                                         │
│     [插画：学生与AI对话的场景]          │
│                                         │
│  选择口语练习模式，系统将根据你的       │
│  年级智能推荐内容                       │
│                                         │
├─────────────────────────────────────────┤
│                                         │
│  ┌───────┐  ┌───────┐  ┌───────┐      │
│  │  📖   │  │  💬   │  │  🎯   │      │
│  │       │  │       │  │       │      │
│  │朗读演讲│  │自由对话│  │情景任务│      │
│  │Reading│  │ Free  │  │Scenario│     │
│  │Speech │  │Dialog │  │ Tasks │      │
│  │       │  │       │  │       │      │
│  │跟读课文│  │与AI角色│  │完成特定│      │
│  │背诵诗歌│  │自由交流│  │场景对话│      │
│  │演讲训练│  │无固定  │  │任务    │      │
│  │       │  │任务   │  │       │      │
│  │[单向输出]│  │[双向互动]│ │[目标导向]│     │
│  │       │  │       │  │       │      │
│  │  [+]  │  │  [+]  │  │  [+]  │      │
│  └───────┘  └───────┘  └───────┘      │
│                                         │
├─────────────────────────────────────────┤
│ 💡 提示：可直接点击 [+] 快速添加       │
│    默认配置的练习                       │
└─────────────────────────────────────────┘
```
  </wireframe>

  <interaction name="select-mode">
    <trigger>点击模式卡片</trigger>
    <function>selectSpeakingMode(modeType)</function>
    <flow>
      <step>设置 currentMode = modeType</step>
      <step>调用 switchToSpeakingMode(modeType)</step>
      <step>调用 showSpeakingConfig(modeType)</step>
      <step>调用 showSpeakingEditArea(modeType)</step>
    </flow>
  </interaction>

  <interaction name="quick-add">
    <trigger>点击 [+] 按钮</trigger>
    <function>quickAddSpeaking(modeType)</function>
    <flow>
      <step>使用默认配置创建练习</step>
      <step>添加到底部大纲</step>
      <step>显示成功提示</step>
      <step>保持在列表视图</step>
    </flow>
  </interaction>

</view>

---

## 第二层：全局设置栏

<component id="global-settings-bar" name="全局设置栏">

  <description>
    在中央工作区顶部显示，配置一次，所有练习共享
  </description>

  <structure>
    <setting name="grade-selector">
      <label>年级</label>
      <options>一年级、二年级、三年级、四年级、五年级、六年级</options>
      <default>三年级</default>
    </setting>

    <setting name="difficulty-selector">
      <label>难度</label>
      <options>简单、中等、困难</options>
      <default>中等</default>
      <smart-adjustment>根据年级自动调整默认值</smart-adjustment>
    </setting>

    <setting name="evaluation-timing">
      <label>评价时机</label>
      <options>
        <option value="per-submission">每次提交后</option>
        <option value="per-round">每轮对话后</option>
        <option value="task-complete">任务完成时</option>
      </options>
      <default>per-round</default>
    </setting>
  </structure>

  <wireframe>
```
┌─────────────────────────────────────────────────────────────┐
│ 全局设置                                                     │
│                                                             │
│  年级: [三年级 ▼]  难度: [中等 ▼]  评价时机: [每轮对话后 ▼] │
│                                                             │
│  💡 这些设置将应用于所有口语练习                              │
└─────────────────────────────────────────────────────────────┘
```
  </wireframe>

  <visibility>
    <condition>点击任意练习模式后显示</condition>
    <position>中央工作区顶部固定</position>
  </visibility>

</component>

---

## 第三层A：朗读演讲配置视图

<view id="reading-config-view" name="朗读演讲配置">

  <structure>
    <config-header>
      <back-button onclick="backToModeList()">← 返回</back-button>
      <title>朗读演讲</title>
      <subtitle>Reading & Speech</subtitle>
    </config-header>

    <config-content>
      <section name="type-selection">
        <label>类型</label>
        <radio-group name="reading-type">
          <option value="follow-read" checked>跟读 (Follow Reading)</option>
          <option value="recite">背诵 (Recitation)</option>
          <option value="speech">演讲 (Speech)</option>
        </radio-group>
      </section>

      <section name="topic-selection">
        <label>主题</label>
        <smart-recommend>
          <badge>🌟 智能推荐</badge>
          <description>根据【三年级】推荐</description>
        </smart-recommend>
        <topic-grid>
          <topic-card value="animals" recommended>
            <icon>🐾</icon>
            <title>动物</title>
            <subtitle>Animals</subtitle>
          </topic-card>
          <topic-card value="family">
            <icon>👨‍👩‍👧‍👦</icon>
            <title>家庭</title>
            <subtitle>Family</subtitle>
          </topic-card>
          <topic-card value="school">
            <icon>🏫</icon>
            <title>校园</title>
            <subtitle>School</subtitle>
          </topic-card>
          <topic-card value="nature">
            <icon>🌳</icon>
            <title>自然</title>
            <subtitle>Nature</subtitle>
          </topic-card>
          <topic-card value="custom">
            <icon>✏️</icon>
            <title>自定义</title>
            <subtitle>Custom</subtitle>
          </topic-card>
        </topic-grid>
      </section>

      <section name="content-input" visible-when="topic !== 'custom'">
        <label>参考文本</label>
        <textarea placeholder="粘贴或输入要朗读的英文文本..."></textarea>
        <file-upload>
          <button>📎 上传文本文件</button>
        </file-upload>
      </section>

      <section name="custom-topic-input" visible-when="topic === 'custom'">
        <label>自定义主题</label>
        <input type="text" placeholder="输入主题名称（中英文）"></input>
        <label>参考文本</label>
        <textarea placeholder="粘贴或输入要朗读的英文文本..."></textarea>
      </section>

      <section name="advanced-options" collapsible>
        <toggle-header>高级选项 ▼</toggle-header>
        <options>
          <toggle name="show-translation">显示中文翻译</toggle>
          <toggle name="highlight-keywords">关键词高亮</toggle>
          <toggle name="speed-control">语速调节</toggle>
          <toggle name="repeat-mode">重复模式</toggle>
        </options>
      </section>
    </config-content>

    <config-footer>
      <button class="btn-secondary" onclick="backToModeList()">取消</button>
      <button class="btn-primary" onclick="addReadingExercise()">添加到课件</button>
    </config-footer>
  </structure>

  <wireframe>
```
┌─────────────────────────────────────────┐
│ ← 返回        朗读演讲                   │
│              Reading & Speech           │
├─────────────────────────────────────────┤
│                                         │
│ 类型                                    │
│ ○ 跟读 (Follow Reading)                 │
│ ○ 背诵 (Recitation)                     │
│ ○ 演讲 (Speech)                         │
│                                         │
├─────────────────────────────────────────┤
│ 主题                                    │
│ 🌟 智能推荐 | 根据【三年级】推荐        │
│                                         │
│ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐       │
│ │ 🐾  │ │👨‍👩‍👧‍│ │ 🏫  │ │ 🌳  │       │
│ │动物 │ │家庭 │ │校园 │ │自然 │       │
│ │[推荐]│ │Family│ │School│ │Nature│      │
│ └─────┘ └─────┘ └─────┘ └─────┘       │
│                                         │
│ ┌─────┐                                │
│ │ ✏️  │                                │
│ │自定义│                                │
│ │Custom│                               │
│ └─────┘                                │
│                                         │
├─────────────────────────────────────────┤
│ 参考文本                                │
│ ┌─────────────────────────────────────┐│
│ │ 粘贴或输入要朗读的英文文本...        ││
│ │                                     ││
│ │                                     ││
│ └─────────────────────────────────────┘│
│ [📎 上传文本文件]                       │
│                                         │
├─────────────────────────────────────────┤
│ 高级选项 ▼                              │
│ ☑ 显示中文翻译                          │
│ ☑ 关键词高亮                            │
│ ☐ 语速调节                              │
│ ☐ 重复模式                              │
│                                         │
├─────────────────────────────────────────┤
│              [取消]  [添加到课件]        │
└─────────────────────────────────────────┘
```
  </wireframe>

  <interaction name="add-reading-exercise">
    <trigger>点击【添加到课件】按钮</trigger>
    <function>addReadingExercise()</function>
    <flow>
      <step>验证必填项（参考文本不能为空）</step>
      <step>创建练习配置对象</step>
      <step>调用 switchToSpeakingMode('reading')</step>
      <step>在中央工作区显示朗读编辑界面</step>
      <step>在底部大纲添加练习缩略图</step>
      <step>隐藏配置视图，显示列表视图</step>
    </flow>
  </interaction>

</view>

---

## 第三层B：自由对话配置视图

<view id="dialogue-config-view" name="自由对话配置">

  <structure>
    <config-header>
      <back-button onclick="backToModeList()">← 返回</back-button>
      <title>自由对话</title>
      <subtitle>Free Dialogue</subtitle>
    </config-header>

    <config-content>
      <section name="mode-selection">
        <label>模式</label>
        <radio-group name="dialogue-mode">
          <option value="chat" checked>
            <title>闲聊 (Casual Chat)</title>
            <description>轻松愉快的日常对话</description>
          </option>
          <option value="discussion">
            <title>讨论 (Discussion)</title>
            <description>针对特定话题深入交流</description>
          </option>
          <option value="interview">
            <title>访谈 (Interview)</title>
            <description>模拟面试或采访场景</description>
          </option>
        </radio-group>
      </section>

      <section name="role-selection">
        <label>AI 角色</label>
        <smart-recommend>
          <badge>🌟 智能推荐</badge>
          <description>根据【三年级】和【中等难度】推荐</description>
        </smart-recommend>
        <role-grid>
          <role-card value="friend" recommended>
            <avatar>👦</avatar>
            <name>Tom</name>
            <role>同龄朋友</role>
            <traits>友好、耐心、鼓励型</traits>
          </role-card>
          <role-card value="teacher">
            <avatar>👩‍🏫</avatar>
            <name>Ms. Green</name>
            <role>英语老师</role>
            <traits>专业、温和、启发式</traits>
          </role-card>
          <role-card value="tourist">
            <avatar>🧳</avatar>
            <name>Lisa</name>
            <role>外国游客</role>
            <traits>好奇、开放、文化交流</traits>
          </role-card>
          <role-card value="custom">
            <avatar>✏️</avatar>
            <name>自定义</name>
            <role>创建角色</role>
            <traits>自定义性格特征</traits>
          </role-card>
        </role-grid>
      </section>

      <section name="topic-selection">
        <label>话题范围（可多选）</label>
        <topic-chips>
          <chip value="hobbies" selected>兴趣爱好 Hobbies</chip>
          <chip value="daily-life" selected>日常生活 Daily Life</chip>
          <chip value="school">学校 School</chip>
          <chip value="family">家庭 Family</chip>
          <chip value="food">美食 Food</chip>
          <chip value="sports">运动 Sports</chip>
          <chip value="movies">电影 Movies</chip>
          <chip value="music">音乐 Music</chip>
          <chip value="travel">旅行 Travel</chip>
          <chip value="custom">自定义 Custom</chip>
        </topic-chips>
      </section>

      <section name="custom-role-config" visible-when="role === 'custom'">
        <label>角色名称</label>
        <input type="text" placeholder="输入角色名称"></input>
        <label>角色设定</label>
        <textarea placeholder="描述角色的性格、背景、说话方式..."></textarea>
      </section>

      <section name="advanced-options" collapsible>
        <toggle-header>高级选项 ▼</toggle-header>
        <options>
          <toggle name="auto-prompt">智能提示（当学生不知道说什么时）</toggle>
          <toggle name="vocabulary-hints">词汇提示</toggle>
          <toggle name="grammar-correction">语法纠正</toggle>
          <slider name="dialogue-length">
            <label>对话轮次</label>
            <range min="3" max="20" value="10"></range>
            <display>10 轮</display>
          </slider>
        </options>
      </section>
    </config-content>

    <config-footer>
      <button class="btn-secondary" onclick="backToModeList()">取消</button>
      <button class="btn-primary" onclick="addDialogueExercise()">添加到课件</button>
    </config-footer>
  </structure>

  <wireframe>
```
┌─────────────────────────────────────────┐
│ ← 返回        自由对话                   │
│              Free Dialogue              │
├─────────────────────────────────────────┤
│                                         │
│ 模式                                    │
│ ○ 闲聊 (Casual Chat)                    │
│   轻松愉快的日常对话                     │
│ ○ 讨论 (Discussion)                     │
│   针对特定话题深入交流                   │
│ ○ 访谈 (Interview)                      │
│   模拟面试或采访场景                     │
│                                         │
├─────────────────────────────────────────┤
│ AI 角色                                 │
│ 🌟 智能推荐 | 根据【三年级】【中等】    │
│                                         │
│ ┌───────┐ ┌───────┐ ┌───────┐         │
│ │  👦   │ │ 👩‍🏫   │ │  🧳   │         │
│ │  Tom  │ │Ms.Green│ │ Lisa  │         │
│ │同龄朋友│ │英语老师│ │外国游客│         │
│ │友好耐心│ │专业温和│ │文化交流│         │
│ │ [推荐] │ │       │ │       │         │
│ └───────┘ └───────┘ └───────┘         │
│                                         │
│ ┌───────┐                              │
│ │  ✏️   │                              │
│ │自定义 │                              │
│ │创建角色│                              │
│ └───────┘                              │
│                                         │
├─────────────────────────────────────────┤
│ 话题范围（可多选）                       │
│ [兴趣爱好✓] [日常生活✓] [学校] [家庭]  │
│ [美食] [运动] [电影] [音乐] [旅行]     │
│ [自定义+]                               │
│                                         │
├─────────────────────────────────────────┤
│ 高级选项 ▼                              │
│ ☑ 智能提示（当学生不知道说什么时）      │
│ ☑ 词汇提示                              │
│ ☐ 语法纠正                              │
│                                         │
│ 对话轮次                                │
│ ├───────●─────────┤ 10 轮             │
│ 3                20                    │
│                                         │
├─────────────────────────────────────────┤
│              [取消]  [添加到课件]        │
└─────────────────────────────────────────┘
```
  </wireframe>

  <interaction name="add-dialogue-exercise">
    <trigger>点击【添加到课件】按钮</trigger>
    <function>addDialogueExercise()</function>
    <flow>
      <step>验证必填项（至少选择一个话题）</step>
      <step>创建练习配置对象</step>
      <step>调用 switchToSpeakingMode('dialogue')</step>
      <step>在中央工作区显示对话编辑界面</step>
      <step>在底部大纲添加练习缩略图</step>
      <step>隐藏配置视图，显示列表视图</step>
    </flow>
  </interaction>

</view>

---

## 第三层C：情景任务配置视图

<view id="scenario-config-view" name="情景任务配置">

  <structure>
    <config-header>
      <back-button onclick="backToModeList()">← 返回</back-button>
      <title>情景任务</title>
      <subtitle>Scenario Tasks</subtitle>
    </config-header>

    <config-content>
      <section name="scenario-selection">
        <label>场景</label>
        <smart-recommend>
          <badge>🌟 智能推荐</badge>
          <description>根据【三年级】推荐</description>
        </smart-recommend>
        <scenario-grid>
          <scenario-card value="restaurant" recommended>
            <icon>🍽️</icon>
            <title>餐厅点餐</title>
            <subtitle>Restaurant</subtitle>
            <tasks>点餐、询问菜品、结账</tasks>
          </scenario-card>
          <scenario-card value="shopping">
            <icon>🛍️</icon>
            <title>购物</title>
            <subtitle>Shopping</subtitle>
            <tasks>询价、试穿、砍价、付款</tasks>
          </scenario-card>
          <scenario-card value="direction">
            <icon>🗺️</icon>
            <title>问路</title>
            <subtitle>Asking Directions</subtitle>
            <tasks>询问位置、理解指路、确认</tasks>
          </scenario-card>
          <scenario-card value="airport">
            <icon>✈️</icon>
            <title>机场</title>
            <subtitle>Airport</subtitle>
            <tasks>办登机、安检、找登机口</tasks>
          </scenario-card>
          <scenario-card value="doctor">
            <icon>🏥</icon>
            <title>看病</title>
            <subtitle>Doctor Visit</subtitle>
            <tasks>描述症状、理解医嘱</tasks>
          </scenario-card>
          <scenario-card value="custom">
            <icon>✏️</icon>
            <title>自定义</title>
            <subtitle>Custom</subtitle>
            <tasks>创建自己的场景</tasks>
          </scenario-card>
        </scenario-grid>
      </section>

      <section name="task-nodes-preview" visible-when="scenario !== 'custom'">
        <label>任务节点预览</label>
        <node-flow>
          <node number="1" status="required">
            <title>进入餐厅，与服务员打招呼</title>
            <example>"Hello! Table for one, please."</example>
          </node>
          <arrow>↓</arrow>
          <node number="2" status="required">
            <title>查看菜单，询问推荐菜品</title>
            <example>"What do you recommend?"</example>
          </node>
          <arrow>↓</arrow>
          <node number="3" status="required">
            <title>点餐</title>
            <example>"I'd like the pasta, please."</example>
          </node>
          <arrow>↓</arrow>
          <node number="4" status="optional">
            <title>询问菜品细节（可选）</title>
            <example>"Is it spicy?"</example>
          </node>
          <arrow>↓</arrow>
          <node number="5" status="required">
            <title>结账</title>
            <example>"Check, please."</example>
          </node>
        </node-flow>
        <edit-button onclick="showNodeEditor()">编辑节点</edit-button>
      </section>

      <section name="custom-scenario-config" visible-when="scenario === 'custom'">
        <label>场景名称</label>
        <input type="text" placeholder="输入场景名称（中英文）"></input>
        <label>场景描述</label>
        <textarea placeholder="描述场景的背景、目标、角色..."></textarea>
        <label>任务节点</label>
        <node-editor>
          <node-item>
            <drag-handle>⋮⋮</drag-handle>
            <node-config>
              <input placeholder="节点标题"></input>
              <textarea placeholder="示例对话"></textarea>
              <toggle name="required">必需节点</toggle>
            </node-config>
            <delete-button>🗑️</delete-button>
          </node-item>
          <add-node-button>+ 添加节点</add-node-button>
        </node-editor>
      </section>

      <section name="advanced-options" collapsible>
        <toggle-header>高级选项 ▼</toggle-header>
        <options>
          <toggle name="flexible-order">允许节点顺序灵活调整</toggle>
          <toggle name="hints-available">提供对话提示</toggle>
          <toggle name="vocabulary-support">词汇支持</toggle>
          <select name="completion-criteria">
            <label>完成标准</label>
            <option value="all-required">完成所有必需节点</option>
            <option value="all-nodes">完成所有节点</option>
            <option value="time-based">限时完成</option>
          </select>
        </options>
      </section>
    </config-content>

    <config-footer>
      <button class="btn-secondary" onclick="backToModeList()">取消</button>
      <button class="btn-primary" onclick="addScenarioExercise()">添加到课件</button>
    </config-footer>
  </structure>

  <wireframe>
```
┌─────────────────────────────────────────┐
│ ← 返回        情景任务                   │
│              Scenario Tasks             │
├─────────────────────────────────────────┤
│                                         │
│ 场景                                    │
│ 🌟 智能推荐 | 根据【三年级】推荐        │
│                                         │
│ ┌───────┐ ┌───────┐ ┌───────┐         │
│ │  🍽️   │ │  🛍️   │ │  🗺️   │         │
│ │餐厅点餐│ │  购物  │ │  问路  │         │
│ │Restaurant│ Shopping│ Directions│      │
│ │点餐询问│ │询价试穿│ │询问位置│         │
│ │ [推荐] │ │       │ │       │         │
│ └───────┘ └───────┘ └───────┘         │
│                                         │
│ ┌───────┐ ┌───────┐ ┌───────┐         │
│ │  ✈️   │ │  🏥   │ │  ✏️   │         │
│ │  机场  │ │  看病  │ │ 自定义 │         │
│ │ Airport │ Doctor │ Custom │         │
│ │办登机口│ │描述症状│ │创建场景│         │
│ └───────┘ └───────┘ └───────┘         │
│                                         │
├─────────────────────────────────────────┤
│ 任务节点预览                [编辑节点]   │
│                                         │
│ ┌─────────────────────────────────────┐│
│ │ 1️⃣ [必需] 进入餐厅,与服务员打招呼   ││
│ │    "Hello! Table for one, please."  ││
│ │              ↓                      ││
│ │ 2️⃣ [必需] 查看菜单,询问推荐菜品     ││
│ │    "What do you recommend?"         ││
│ │              ↓                      ││
│ │ 3️⃣ [必需] 点餐                      ││
│ │    "I'd like the pasta, please."    ││
│ │              ↓                      ││
│ │ 4️⃣ [可选] 询问菜品细节              ││
│ │    "Is it spicy?"                   ││
│ │              ↓                      ││
│ │ 5️⃣ [必需] 结账                      ││
│ │    "Check, please."                 ││
│ └─────────────────────────────────────┘│
│                                         │
├─────────────────────────────────────────┤
│ 高级选项 ▼                              │
│ ☑ 允许节点顺序灵活调整                  │
│ ☑ 提供对话提示                          │
│ ☑ 词汇支持                              │
│                                         │
│ 完成标准                                │
│ ○ 完成所有必需节点                      │
│ ○ 完成所有节点                          │
│ ○ 限时完成                              │
│                                         │
├─────────────────────────────────────────┤
│              [取消]  [添加到课件]        │
└─────────────────────────────────────────┘
```
  </wireframe>

  <interaction name="add-scenario-exercise">
    <trigger>点击【添加到课件】按钮</trigger>
    <function>addScenarioExercise()</function>
    <flow>
      <step>验证必填项（至少包含一个任务节点）</step>
      <step>创建练习配置对象</step>
      <step>调用 switchToSpeakingMode('scenario')</step>
      <step>在中央工作区显示情景编辑界面</step>
      <step>在底部大纲添加练习缩略图</step>
      <step>隐藏配置视图，显示列表视图</step>
    </flow>
  </interaction>

</view>

---

## 第四层：中央工作区编辑界面

<center-area id="speaking-edit-area" name="口语练习编辑区域">

  <state name="reading-edit-mode">
    <description>朗读演讲编辑界面</description>
    <components>
      <component name="text-display-area">
        <reference-text>显示参考文本</reference-text>
        <translation visible-when="show-translation === true">显示中文翻译</translation>
        <keywords-highlight visible-when="highlight-keywords === true">关键词高亮</keywords-highlight>
      </component>
      <component name="audio-controls">
        <play-button>播放示范音频</play-button>
        <speed-selector visible-when="speed-control === true">语速选择</speed-selector>
      </component>
      <component name="recording-area">
        <record-button>开始录音</record-button>
        <waveform-display>显示录音波形</waveform-display>
      </component>
    </components>
  </state>

  <state name="dialogue-edit-mode">
    <description>自由对话编辑界面</description>
    <components>
      <component name="role-display">
        <avatar>显示AI角色头像</avatar>
        <name>角色名称</name>
        <role-description>角色设定简介</role-description>
      </component>
      <component name="topic-tags">
        <tag-list>显示已选话题标签</tag-list>
      </component>
      <component name="dialogue-preview">
        <sample-dialogue>显示示例对话</sample-dialogue>
      </component>
      <component name="settings-panel">
        <dialogue-length-display>对话轮次设置</dialogue-length-display>
        <options-display>显示已启用的选项</options-display>
      </component>
    </components>
  </state>

  <state name="scenario-edit-mode">
    <description>情景任务编辑界面</description>
    <components>
      <component name="scenario-header">
        <icon>场景图标</icon>
        <title>场景名称</title>
        <description>场景描述</description>
      </component>
      <component name="task-flow-canvas">
        <node-flow-editor>
          <node-card>
            <node-number>1</node-number>
            <node-title>节点标题</node-title>
            <node-example>示例对话</node-example>
            <node-badge>必需/可选</node-badge>
          </node-card>
          <connector-line>连接线</connector-line>
        </node-flow-editor>
      </component>
      <component name="completion-criteria">
        <criteria-display>完成标准说明</criteria-display>
      </component>
    </components>
  </state>

  <wireframe name="reading-edit-mode">
```
┌─────────────────────────────────────────────────────────────┐
│ 年级: [三年级 ▼]  难度: [中等 ▼]  评价时机: [每轮对话后 ▼]  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  朗读演讲 - 动物主题                                         │
│                                                             │
│  ┌───────────────────────────────────────────────────────┐ │
│  │                                                       │ │
│  │  The Clever Fox                                      │ │
│  │                                                       │ │
│  │  Once upon a time, there was a clever fox. He       │ │
│  │  lived in a beautiful forest with many animals.     │ │
│  │  The fox was very smart and kind to others.         │ │
│  │                                                       │ │
│  │  [中文翻译]                                           │ │
│  │  从前有一只聪明的狐狸。他住在一个美丽的森林里...     │ │
│  │                                                       │ │
│  └───────────────────────────────────────────────────────┘ │
│                                                             │
│  [▶️ 播放示范]  [语速: 正常 ▼]                              │
│                                                             │
│  ┌───────────────────────────────────────────────────────┐ │
│  │                                                       │ │
│  │         [🎤 开始录音]                                 │ │
│  │                                                       │ │
│  │         ～～～～～～～～～～                            │ │
│  │         录音波形显示                                  │ │
│  │                                                       │ │
│  └───────────────────────────────────────────────────────┘ │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```
  </wireframe>

  <wireframe name="dialogue-edit-mode">
```
┌─────────────────────────────────────────────────────────────┐
│ 年级: [三年级 ▼]  难度: [中等 ▼]  评价时机: [每轮对话后 ▼]  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  自由对话                                                    │
│                                                             │
│  ┌─────────────────────────────────────────────────┐       │
│  │  👦 Tom  |  同龄朋友                             │       │
│  │  友好、耐心、鼓励型                              │       │
│  └─────────────────────────────────────────────────┘       │
│                                                             │
│  话题: [兴趣爱好] [日常生活]                                │
│                                                             │
│  ┌───────────────────────────────────────────────────────┐ │
│  │  示例对话预览:                                        │ │
│  │                                                       │ │
│  │  👦 Tom: Hi! What's your favorite hobby?            │ │
│  │  👤 You: (学生回答)                                  │ │
│  │  👦 Tom: That sounds interesting! Tell me more.     │ │
│  │                                                       │ │
│  └───────────────────────────────────────────────────────┘ │
│                                                             │
│  设置:                                                      │
│  • 对话轮次: 10 轮                                          │
│  • 智能提示: 开启                                           │
│  • 词汇提示: 开启                                           │
│                                                             │
│  [开始配置对话]                                             │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```
  </wireframe>

  <wireframe name="scenario-edit-mode">
```
┌─────────────────────────────────────────────────────────────┐
│ 年级: [三年级 ▼]  难度: [中等 ▼]  评价时机: [任务完成时 ▼] │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  🍽️ 情景任务 - 餐厅点餐                                     │
│                                                             │
│  ┌───────────────────────────────────────────────────────┐ │
│  │                    任务流程                           │ │
│  │                                                       │ │
│  │  ┌─────────────────────────────────────────────┐    │ │
│  │  │ 1️⃣ [必需] 进入餐厅,与服务员打招呼          │    │ │
│  │  │    示例: "Hello! Table for one, please."    │    │ │
│  │  └─────────────────────────────────────────────┘    │ │
│  │                    ↓                                 │ │
│  │  ┌─────────────────────────────────────────────┐    │ │
│  │  │ 2️⃣ [必需] 查看菜单,询问推荐菜品            │    │ │
│  │  │    示例: "What do you recommend?"           │    │ │
│  │  └─────────────────────────────────────────────┘    │ │
│  │                    ↓                                 │ │
│  │  ┌─────────────────────────────────────────────┐    │ │
│  │  │ 3️⃣ [必需] 点餐                              │    │ │
│  │  │    示例: "I'd like the pasta, please."      │    │ │
│  │  └─────────────────────────────────────────────┘    │ │
│  │                    ↓                                 │ │
│  │  ┌─────────────────────────────────────────────┐    │ │
│  │  │ 4️⃣ [可选] 询问菜品细节                      │    │ │
│  │  └─────────────────────────────────────────────┘    │ │
│  │                    ↓                                 │ │
│  │  ┌─────────────────────────────────────────────┐    │ │
│  │  │ 5️⃣ [必需] 结账                              │    │ │
│  │  └─────────────────────────────────────────────┘    │ │
│  │                                                       │ │
│  └───────────────────────────────────────────────────────┘ │
│                                                             │
│  完成标准: 完成所有必需节点                                  │
│                                                             │
│  [编辑节点]  [开始测试]                                     │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```
  </wireframe>

</center-area>

---

## 第五层:底部页面大纲

<component id="bottom-outline" name="底部页面大纲">

  <description>
    显示所有已添加的口语练习，支持拖拽排序和快速切换
  </description>

  <structure>
    <thumbnail-list>
      <exercise-thumbnail type="reading">
        <icon>📖</icon>
        <title>朗读 - 动物</title>
        <page-number>1</page-number>
      </exercise-thumbnail>
      <exercise-thumbnail type="dialogue">
        <icon>💬</icon>
        <title>对话 - Tom</title>
        <page-number>2</page-number>
      </exercise-thumbnail>
      <exercise-thumbnail type="scenario">
        <icon>🍽️</icon>
        <title>餐厅点餐</title>
        <page-number>3</page-number>
      </exercise-thumbnail>
      <add-exercise-button>+ 添加练习</add-exercise-button>
    </thumbnail-list>
  </structure>

  <wireframe>
```
┌─────────────────────────────────────────────────────────────┐
│ ┌──────┐  ┌──────┐  ┌──────┐  ┌──────┐                    │
│ │  📖  │  │  💬  │  │  🍽️  │  │  +   │                    │
│ │朗读  │  │对话  │  │餐厅  │  │添加  │                    │
│ │动物  │  │ Tom  │  │点餐  │  │练习  │                    │
│ │  1   │  │  2   │  │  3   │  │      │                    │
│ └──────┘  └──────┘  └──────┘  └──────┘                    │
└─────────────────────────────────────────────────────────────┘
```
  </wireframe>

  <features>
    <feature>点击缩略图切换到对应练习</feature>
    <feature>拖拽缩略图调整练习顺序</feature>
    <feature>右键菜单: 复制、删除、编辑</feature>
    <feature>显示练习类型图标和标题</feature>
  </features>

</component>

---

## 关键函数流程

<functions>

  <function name="selectSpeakingMode">
    <parameters>
      <param name="modeType">reading | dialogue | scenario</param>
    </parameters>
    <flow>
      <step>设置 currentMode = modeType</step>
      <step>调用 switchToSpeakingMode(modeType)</step>
      <step>调用 showSpeakingConfig(modeType)</step>
    </flow>
  </function>

  <function name="switchToSpeakingMode">
    <parameters>
      <param name="modeType">reading | dialogue | scenario</param>
    </parameters>
    <flow>
      <step>设置 isSpeakingMode = true</step>
      <step>显示全局设置栏</step>
      <step>隐藏普通元素工具栏</step>
      <step>显示底部大纲</step>
      <step>隐藏占位符</step>
      <step>如果未进入编辑模式，生成示例页面</step>
    </flow>
  </function>

  <function name="showSpeakingConfig">
    <parameters>
      <param name="modeType">reading | dialogue | scenario</param>
    </parameters>
    <flow>
      <step>隐藏 speaking-list-view</step>
      <step>显示对应的配置视图:
        - reading → reading-config-view
        - dialogue → dialogue-config-view
        - scenario → scenario-config-view
      </step>
      <step>更新配置标题</step>
      <step>根据类型动态生成配置项</step>
      <step>隐藏面板顶部标题栏</step>
    </flow>
  </function>

  <function name="backToModeList">
    <flow>
      <step>隐藏所有配置视图</step>
      <step>显示 speaking-list-view</step>
      <step>显示面板顶部标题栏</step>
      <step>调用 restoreNormalView()</step>
    </flow>
  </function>

  <function name="quickAddSpeaking">
    <parameters>
      <param name="modeType">reading | dialogue | scenario</param>
    </parameters>
    <flow>
      <step>根据 modeType 和全局设置创建默认配置</step>
      <step>调用对应的添加函数:
        - reading → addReadingExercise()
        - dialogue → addDialogueExercise()
        - scenario → addScenarioExercise()
      </step>
      <step>显示成功提示: "已添加默认配置的练习"</step>
      <step>保持在 speaking-list-view</step>
    </flow>
  </function>

  <function name="addReadingExercise">
    <flow>
      <step>验证表单（参考文本不能为空）</step>
      <step>创建练习配置对象:
        {
          type: 'reading',
          readingType: '跟读/背诵/演讲',
          topic: '主题',
          referenceText: '参考文本',
          showTranslation: true/false,
          highlightKeywords: true/false,
          ...
        }
      </step>
      <step>调用 switchToSpeakingMode('reading')</step>
      <step>在中央工作区显示朗读编辑界面</step>
      <step>在底部大纲添加练习缩略图</step>
      <step>同步右侧大纲</step>
      <step>调用 backToModeList()</step>
    </flow>
  </function>

  <function name="addDialogueExercise">
    <flow>
      <step>验证表单（至少选择一个话题）</step>
      <step>创建练习配置对象:
        {
          type: 'dialogue',
          dialogueMode: 'chat/discussion/interview',
          role: '角色配置',
          topics: ['话题列表'],
          dialogueLength: 10,
          ...
        }
      </step>
      <step>调用 switchToSpeakingMode('dialogue')</step>
      <step>在中央工作区显示对话编辑界面</step>
      <step>在底部大纲添加练习缩略图</step>
      <step>同步右侧大纲</step>
      <step>调用 backToModeList()</step>
    </flow>
  </function>

  <function name="addScenarioExercise">
    <flow>
      <step>验证表单（至少包含一个任务节点）</step>
      <step>创建练习配置对象:
        {
          type: 'scenario',
          scenario: '场景名称',
          nodes: [
            { number: 1, title: '节点标题', example: '示例', required: true },
            ...
          ],
          completionCriteria: 'all-required/all-nodes/time-based',
          ...
        }
      </step>
      <step>调用 switchToSpeakingMode('scenario')</step>
      <step>在中央工作区显示情景编辑界面</step>
      <step>在底部大纲添加练习缩略图</step>
      <step>同步右侧大纲</step>
      <step>调用 backToModeList()</step>
    </flow>
  </function>

</functions>

---

## 状态变量

<state-variables>
  <variable name="isSpeakingMode" type="boolean">
    <description>是否处于口语练习模式</description>
    <default>false</default>
  </variable>

  <variable name="currentMode" type="string">
    <description>当前选中的练习模式</description>
    <values>reading, dialogue, scenario</values>
    <default>null</default>
  </variable>

  <variable name="globalSettings" type="object">
    <description>全局设置</description>
    <structure>
      {
        grade: '三年级',
        difficulty: '中等',
        evaluationTiming: 'per-round'
      }
    </structure>
  </variable>

  <variable name="exercises" type="array">
    <description>已添加的练习列表</description>
    <structure>
      [
        {
          id: 'exercise-1',
          type: 'reading',
          config: { ... },
          pageNumber: 1
        },
        ...
      ]
    </structure>
  </variable>
</state-variables>

---

## CSS 类状态

<css-states>
  <state class=".active">
    <usage>激活状态（菜单项、卡片、缩略图）</usage>
  </state>

  <state class=".hidden">
    <usage>隐藏元素（display: none）</usage>
  </state>

  <state class=".visible">
    <usage>显示元素（全局设置栏、底部大纲）</usage>
  </state>

  <state class=".selected">
    <usage>选中状态（话题标签、卡片）</usage>
  </state>

  <state class=".recommended">
    <usage>推荐标记（卡片、选项）</usage>
  </state>

  <state class=".required">
    <usage>必需节点标记</usage>
  </state>

  <state class=".optional">
    <usage>可选节点标记</usage>
  </state>
</css-states>

---

## 设计规范

<design-tokens>
  <token name="primary-color">#ff9500</token>
  <token name="secondary-color">#374151</token>
  <token name="success-color">#10b981</token>
  <token name="warning-color">#f59e0b</token>
  <token name="border-color">#e5e7eb</token>
  <token name="bg-hover">#f9fafb</token>
  <token name="card-border-radius">12px</token>
  <token name="button-border-radius">10px</token>
  <token name="panel-width">420px</token>
  <token name="card-padding">16px</token>
  <token name="gap-small">8px</token>
  <token name="gap-medium">12px</token>
  <token name="gap-large">16px</token>
</design-tokens>

---

## 向后兼容性说明

<backward-compatibility>
  <principle>
    所有原有功能通过配置项保留，确保现有用户无需重新学习
  </principle>

  <mapping>
    <original-feature name="场景化对话（有固定任务流程）">
      <new-implementation>情景任务模式</new-implementation>
      <config>
        scenario: '选择预设场景或自定义',
        nodes: '任务节点列表'
      </config>
    </original-feature>

    <original-feature name="场景化对话（无固定任务流程）">
      <new-implementation>自由对话模式</new-implementation>
      <config>
        dialogueMode: 'chat',
        role: '选择AI角色',
        topics: '话题范围'
      </config>
    </original-feature>

    <original-feature name="跟读课文">
      <new-implementation>朗读演讲模式</new-implementation>
      <config>
        readingType: 'follow-read',
        referenceText: '课文内容'
      </config>
    </original-feature>

    <original-feature name="背诵诗歌">
      <new-implementation>朗读演讲模式</new-implementation>
      <config>
        readingType: 'recite',
        referenceText: '诗歌内容'
      </config>
    </original-feature>

    <original-feature name="演讲训练">
      <new-implementation>朗读演讲模式</new-implementation>
      <config>
        readingType: 'speech',
        referenceText: '演讲稿'
      </config>
    </original-feature>

    <original-feature name="自适应难度">
      <new-implementation>全局设置 + 智能推荐</new-implementation>
      <config>
        globalSettings.grade: '年级',
        globalSettings.difficulty: '难度',
        smartRecommend: true
      </config>
    </original-feature>

    <original-feature name="发音评估时机">
      <new-implementation>全局设置</new-implementation>
      <config>
        globalSettings.evaluationTiming: 'per-submission | per-round | task-complete'
      </config>
    </original-feature>
  </mapping>
</backward-compatibility>

---

## 实现优先级

<implementation-priority>
  <phase number="1" name="核心框架">
    <task>实现侧边栏 Tag 和二级面板结构</task>
    <task>实现 speaking-list-view（3个模式卡片）</task>
    <task>实现视图切换逻辑（列表视图 ↔ 配置视图）</task>
  </phase>

  <phase number="2" name="配置视图">
    <task>实现朗读演讲配置视图</task>
    <task>实现自由对话配置视图</task>
    <task>实现情景任务配置视图</task>
  </phase>

  <phase number="3" name="全局设置">
    <task>实现全局设置栏（年级/难度/评价时机）</task>
    <task>实现智能推荐逻辑</task>
  </phase>

  <phase number="4" name="中央编辑区">
    <task>实现朗读编辑界面</task>
    <task>实现对话编辑界面</task>
    <task>实现情景编辑界面</task>
  </phase>

  <phase number="5" name="底部大纲">
    <task>实现练习缩略图展示</task>
    <task>实现拖拽排序功能</task>
    <task>实现快速切换功能</task>
  </phase>

  <phase number="6" name="增强功能">
    <task>实现 [+] 快捷添加功能</task>
    <task>实现自定义场景/角色功能</task>
    <task>实现任务节点编辑器</task>
  </phase>
</implementation-priority>